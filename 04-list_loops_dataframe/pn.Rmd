---
title: "List, Loops, and Data frame (W4)"
date: '2019-10-03'
output:
    html_document:
        number_sections: no
        theme: united
        highlight: tango
        toc: yes
        toc_float:
            collapsed: no
        css: style.css
        md_extensions: +implicit_figures
        includes:
            in_header: "../GA.html"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=T,
                      results = 'hide',
                      comment = '#>',
                      message = F)
```



```{js echo=FALSE}
window.onload = () => {
        document.querySelectorAll('.hide').forEach(ele => {
            ele.className = 'note';
        })
}
```

## list

<div class="hide" data-tag="Why lists?">
1. Vector 只能儲存相同資料類型
1. list 能儲存**不同資料類型** (各種 vector)
1. list: hierarchical structure
</div>


<div class="hide" data-tag="list Demo">

1. Create a list

    ```{r}
    list(20, FALSE, c("ig", "selfie"))
    list(age = 20, single = FALSE, tags = c("ig", "selfie"))
    
    # Nested structure
    lst1 <- list(1:3, TRUE)
    list('hello', lst1)
    ```
2. Subset (篩選)
    
    ```{r}
    ben <- list(age = 20, single = FALSE, tags = c("ig", "selfie"))
    ben[1:2]
    ben[c(T, F, T)]
    ben['single']
    ```

    ```{r}
    ben['tags']
    ben[['tags']]
    ```
    
    - **slide**: list as a train analogy
        - 將 list 想像成一輛火車，一個 list 裡面的元素 **的值**儲存在火車的車廂**之內**
        
    - Pop Quiz
</div>


<div class="hide" data-tag="Nested Structure">
```{r}
a_lst <- list(name = "ben",
              info = list(age = 20,
                          tags = c("ig", "selfie")))

# Get "selfie"
a_lst[['info']]
a_lst[['info']][['tags']]
a_lst[['info']][['tags']][1]

a_lst$info
a_lst$info$tags
a_lst$info$tags[2]
```

- 提醒 list 在 console 印出的東西的用途：
  
  ```
  > a_lst
  $name
  [1] "ben"
  
  $info
  $info$age
  [1] 20
  
  $info$tags
  [1] "ig"     "selfie"
  ```
  
  ```r
  a_lst$name
  a_lst$$info$age
  ```
</div>

**3 min**

## for loop

<div class="hide" data-tag="For Loop">
1. Basics

    ```{r}
    for (elem in 1:3) {
        print(elem)
    }
    
    for (i in 1:5) {
        print(i)
    }
    
    # Use character vector: `for_prof.R`
    vec <- c("謝", "老師", "好", "帥")
    for (word in vec) {
        print(word)
    }
    
    # `if` 遇到最後一個字: 帥
    for (word in vec) {
        print(word)
        
        if (word == "帥") {
            print('Really?')
        }
    }
    ```

2. seq_along

    ```{r}
    # seq_along
    for (i in seq_along(vec)) {
        print(i)
    }
    for (i in seq_along(vec)) {
        print(vec[i])
    }
    
    # rewrite 遇到最後一個字
    for (i in seq_along(vec)) {
        print(vec[i])
        
        if (i == length(vec)) {
            print('Really?')
        }
    }
    ```

3. names `for_names.R`

    ```{r}
    vec <- c(Monday = "rainy", Tuesday = "cloudy", Wednesday = "sunny")
    names(vec)

    for (name in names(vec)) {
        sentence <- paste0(name, ' was ', vec[name])
        print(sentence)
    }
    ```
</div>

**3 min**

## Building a for loop `build_for_loop.R`

<div class="hide" data-tag="Wrap up: building a for loop">

**slide**: building a for loop

```{r echo=T, results = 'hide'}
member <- list(
    kai = list(age = 40, about = "a professor"),
    jessy = list(age = 20, about = "a cat lover"),
    joy = list(age = 18, about = "a hacker"),
    ben = list(age = 19, about = "a YouTuber")
)
```

1. Always start with **one concrete case**
2. solve one case and then move on

**Demo**


1. 觀察 `member`, 印出一個句子
    
    ```{r}
    member[['kai']]
    phrases <- c('kai', member[['kai']]$about, 'should be wise.')
    sentence <- paste0(phrases, collapse = ', ')  # explain
    ```

2. 抽象化

    1. 使用 `name` 作為 for 變數 --> 將 `'kai'` 改為 `name`
    
    ```{r}
    for (name in names(member)) {
        member[['kai']]
        phrases <- c('kai', member[['kai']]$about, 'should be wise.')
        sentence <- paste0(phrases,  collapse = ', ')
    }
    ```
    
    2. 加入 `someone` --> 印看看
  
    ```{r results = 'show'}
    for (name in names(member)) {
        someone <- member[[name]]  # 加入 someone
        phrases <- c(name, someone$about, 'should be wise.')  # 加入 someone
        sentence <- paste0(phrases,  collapse = ', ')
        
        print(sentence)  # print intermediate results
    }
    ```
    
    3. 加入條件式
  
    ```{r results = 'show'}
    for (name in names(member)) {
        someone <- member[[name]]
        
        # Construct phrases from `someone`
        phrases <- c(name, someone$about, 'should be wise.')
        if (someone$age < 35) {
            phrases[3] <- 'is quite young.'
        }
        
        sentence <- paste0(phrases,  collapse = ', ')
        
        print(sentence)
    }
    ```
</div>

## Data Frame `tibble.R`

<div class="hide" data-tag="Data Frame">
1. **slide**: 
    - data frame vs. Excel analogy
        - Format: columns for variables, rows for observations
        - read df from csv or construct directly
    - Construct data frame in R (`tibble` vs `data.frame`)

1. Demo: Construct data frame

    ```r
    View(df)
    nrow(df)   # number of rows
    ncol(df)   # number of columns
    dim(df)    # 形狀 (num of rows, num of columns)
    names(df)  # name of each column
    tibble::glimpse(df)  # 關於 df 的各種資訊  
    ```

1. **slide**: 從 data frame 篩選出數值 (說明 2 vector)
    - vector `[]` --> vector  
    list `[]` --> list  
    df `[]` --> df

1. slide, demo alternate

    ```r
    # slide 1
    df[2, 1]
    
    # slide 2
    df[2, 1:2]
    df[2, c("name", "age")]
    
    # slide 3
    df[2, ]
    ```

1. Their turn
</div>

**2 min**

<div class="hide" data-tag="Returning a vector">

1. 篩選 vector, list, 或是 data frame:
    - 使用 `[]` 回傳相同的資料結構
    - 使用 `[[]]` 脫開 list 或 data frame 的外衣

      ```r
      df[['age']]
      df[[2]]
      df$age
      ```

2. logical subsetting

    ```r
    df$age > 19  
    
    # subset df with obs. over 19
    df[df$age > 19, ]
    
    # 更複雜的篩選：boolean operator
    df[(df$age < 20) & (df$grad), ]
    ```
</div>


## 作業繳交

<div class="hide" data-tag="">
1. 只有寫 R Markdown，沒有輸出成 HTML
2. 成功輸出，擔心沒有上傳成功
</div>
