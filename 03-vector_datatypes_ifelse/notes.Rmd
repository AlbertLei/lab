---
title: "Vectors, Data types, if-else (W3)"
date: "2019-09-26"
output:
  html_document:
    number_sections: no
    theme: united
    highlight: tango
    toc: yes
    toc_float:
      collapsed: no
    css: style.css
    md_extensions: +implicit_figures
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      comment = '#>',
                      message = F,
                      results = 'hold')
```


```{js echo=FALSE}
window.onload = () => {
    if (window.location.href.startsWith('https://rlads2019.netlify.com/lab/') ||
        window.location.href.startsWith('file:///home/liao/Desktop/Lab/')) {
        document.querySelectorAll('.hide').forEach(ele => {
            ele.className = 'note';
        })
    }
}
```


<!-- 
- `c()`: concatenate
- flat stucture
- built-in functions: `sum(1:10)`, `mean(1:10)`, `sample(1:10)`, `rep()`
-->

## vector

- 上週實習課使用 R 時，指令的回傳值多半只有「一個」。但 R 其實是一種以**向量**作為基本單位的程式語言，所以對於「一個回傳值」更精確的描述是「一個**長度為 1** 的向量」。
```{r results='hold'}
x <- 2
x

is.vector(x)
length(x)
```


- 我們上週簡短提過以 `:` 製造數列的方式 (e.g. `1:10`)。事實上，這個回傳的數列即是一個 vector。另外，由於這個 vector 的每個元素皆是整數，因此這個 vector 屬於 integer vector。我們可以使用 `typeof()` 確認 vector 的類別
    ```{r}
    typeof(1:10)
    ```

- R 裡面的 vector 可以被分成 6 種類別，其中常見的 4 種分別為 `integer`, `double`, , `character`, `logical`

### integer vector

- integer vector 的元素由整數組成，它可以是零、正或負的。除了使用 `:` 製造數列，也可以使用 `c()` (稱為 concatenate) 組出任意序列的 vector。
    - 使用 `c()` 製造 integer vector 時，每個整數數字後面必須接 `L`，若沒有加上 `L`， R 會將製造出來的 vector 視為 double vector。

```{r results='hold'}
int_vec <- c(-1L, 5L, 2L)
dbl_vec <- c(-1, 5, 2)
int_vec
dbl_vec

typeof(int_vec)
typeof(dbl_vec)
```

### double vector

- double vector 儲存的是[浮點數](https://zh.wikipedia.org/wiki/%E6%B5%AE%E7%82%B9%E6%95%B0)，亦即含有小數點的數字 (e.g `1.2`, `-0.75`)

- 在 R 裡面，integer vector 與 double vector 合稱為 numeric vector，兩者之間的區隔通常也不太重要，因為 R 在運算時，通常會將這兩種資料類型自動轉換成合適的類型

    ```{r results='hold'}
    typeof(2L)
    typeof(2.0)
    
    is.numeric(2L)
    is.numeric(2.0)
    ```

    ```{r results='hold'}
    typeof(1L + 1.0)
    typeof(1L / 2L)
    ```

### character vector

- 除了數字以外，R 也可以儲存**字串 (string)**。character vector 的每個元素皆由一個字串所組成。在 R 裡面，只要是被引號 (quote, `'` 或 `"` 皆可)
包裹的東西就是字串，放在引號內的可以是任何字元 (e.g. 空白、數字、中文字、英文字母)
    ```{r}
    "1.1"  # This is a string (or character vector of length 1), not double
    "你 好！"
    c("1.1", "你 好！")
    ```


- 如果字串內含有引號 `"`，需在字串內的引號前使用跳脫字元 `\`，以表示此引號是字串的一部分而非字串的開頭或結尾
    - 或是，你可以使用「不同的」引號。例如以「單引號」表示字串的開頭與結尾時，字串內就可以直接使用「雙引號」，反之亦然
    
    ```{r results='hold'}
    "\""  # escape a double quote
    '\''  # escape a single quote
    '"'   # a double quote as string without escaping
    "'"   # a single quote as string without escaping
    ```


### logical vector

- `TRUE` or `FALSE`

- 製造 logical vector:
    1. 手動輸入：`c()`
    1. logical tests
        - logical operators: `==`, `!=`, `>`, `<`, `%in%`  
        ![Logical Operators](https://img.yongfu.name/rlads/logical-operators.png)
        - boolean operators: `&`, `|`, `!`, `any()`, `all()`  
        ![Boolean Operators](https://img.yongfu.name/rlads/boolean-operators.png)

```{r}
c(TRUE, FALSE, TRUE)
1 == 1
c(1, 2, 3) == c(1, 3, 3)

1 == 1 & 1!= 2
```


## recycling

```{r}
x <- c(1, 1, 2, 2)

x == c(2, 2, 2, 2)  # equivalent to...
x == 2
```

- `paste0()`

- element-wise comparison

    ```{r}
    x <- c(1, 1, 2, 2)
    
    x + 2  # equivalent to...
    x + c(2, 2, 2, 2)
    ```


## Coercion

![Rules of Coercion](https://rstudio-education.github.io/hopr/images/hopr_0301.png){.half}

- if coercion failed, throw error

- manual coercion: `as.character()`, `as.logical()`, `as.numeric()`

```{r}
sum(c(T, T, T, F))

gender <- c("male", "female", "male", "female")
sum(gender == "male")  # num of male
mean(gender == "male")  # proportion of male
```

## Subsetting a vector

### index subsetting

```{r}
# z[<integer or integer_vector>]
a2z <- LETTERS
a2z[1]
a2z[1:5]
a2z[c(1, 3, 5)]
```

### Logical subsetting

```{r}
# z[<logical_vector>]
age <- c(21, 20, 18, 19)
age[c(FALSE, TRUE, FALSE, TRUE)]

## Creating logical vectors
age[1] < 20  # return logical vector of length 1
age < 20     # return logical vector of length(x)
# Subset vector
age[age < 20]
```


### Subsetting with names

```{r}
age <- c(kai = 40, jessy = 20, sean = 18, yola = 19)
age
age['kai'] + 9

age[c('jessy', 'kai')]
```



## Modifying Values in vector

- assignment: `x[1] <- 10`


## Vectorization

```{r}
# weighted mean
prob <- c(1/6, 1/6, 1/6, 1/6, 1/6)
```


```{r}
vec1 <- c(1, 2, 3)
vec2 <- c(-1, -1, 1)
vec1 * vec2

inner_product <- sum(vec1 * vec2)
```

-----------
<!-- 
Conceptually new topic:
Add if-else concept and then wrap up
-->

## if else 

```{r}
x <- 1

if (x > 0) {
    print('x is positive')
} else {
    print('x is not positive')
}
```
      
```{r}
x <- -1

if (x > 0) {
    print('x is positive')
} else if (x < 0) {
    print('x is negative')
} else {
    print('x is zero')
}
```  
Note: can use multiple `else if`.
      
- template

    ```r
    if (<condition 1>) {
        < do something >
    } else if ( < condition 2 > ) {
        < do something >
    } else {
        < do something >
    }
    ```


## Wrap up (build upon if-else):

- ToDo: 想出一個 program 會用到前面的東西
  - `%in%`: combine if-else and vector


```{r construct-a-comparitive-sentence}
name <- c("kai", "jessy", "sean", "yola")
age <- c(40, 20, 18, 19)
about <- c("a professor", "a cat lover", "a hacker", "a YouTuber")

draws <- sample(1:4, size = 2)
if (age[draws[1]] > age[draws[2]]) {
    comparitive <-  'is older than'
} else if (age[draws][1] < age[draws][2]) {
    comparitive <-  'is younger than'
} else {
    comparitive <-  'is the same age as'
}
roles <- paste0(name[draws], ', ' , about[draws])
roles

paste0(roles[1], ', ', comparitive, ' ', roles[2], '.')
```


## 參考資料

- Hands-on programming with R
  - [R Objects](https://rstudio-education.github.io/hopr/r-objects.html)
  - [Modifying Values](https://rstudio-education.github.io/hopr/modify.html)
