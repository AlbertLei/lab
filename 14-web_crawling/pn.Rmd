---
title: "網頁剖析"
date: '2019-12-12'
output:
    html_document:
        number_sections: no
        theme: united
        highlight: tango
        toc: yes
        toc_float:
            collapsed: no
        css: style.css
        md_extensions: +implicit_figures
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=T,
                      results = 'hide',
                      comment = '#>',
                      message = F,
                      out.width = '80%',
                      fig.align = 'center')
library(ggplot2)
```

```{js echo=FALSE}
window.onload = () => {
        document.querySelectorAll('.hide').forEach(ele => {
            ele.className = 'note';
        })
}
```

- GitHub 版權, 公開問題

## Openning

<div class="hide" data-tag="Openning">
1. 上週 HTML/CSS --> 因為跟網頁剖析 --> 掌握剖析網頁最困難的部份
</div>


## Review CSS

<div class="hide" data-tag="child.html">
1. Review: nested structure of `<ol>`, CSS
    - 4 children (2 grandchildren)
    - `<style>`
1. Change outer `<ol>` to `<ul>` (becomes nested `<ul>`)
    - How to style inner `li` (under the second `ul`)
    
    ```css
    ul > li {
        color: red;
    }

    ul > ul > li {
        color: red;
    }
    ```

    - Composing child selector

1. Add `<a>` in `<li>` (explain link)

    ```html
    <ul>
        <li>list item one</li>
        <li>list item two</li>
        <ul>
            <li>sublist item one</li>
            <li>
                I want <a href="https://google.com">this link</a> styled
            </li>
        </ul>
        <li>list item three</li>
    </ul>

    <ul>
        <li>
            I don't want <a href="https://google.com">this link</a> styled
        </li>
    </ul>
    ```

    ```css
    ul > ul > li > a {
        color: green;
    }
    ```
</div>

## Your Turn (2 min)

`imt.html`: style web site link

- 說明
    - decompose: 3 part, `div.institute`, `ul.member`, `footer`
    - css: what makes the web site looks differently (list --> block)
        - 不用管其它的，只看最上面

- Explain

## rvest

<div class="hide" data-tag="rvest">
1. Review `httr`

    ```r
    library(httr)
    library(rvest)

    req <- GET("https://rlads2019.github.io", 
               path = c("14", "imt.html"))
    req[["status_code"]]
    html <- content(req)
    ```

1. rvest basics

    ```r
    library(rvest)
    html %>% html_nodes("head") %>% html_nodes("title")
    html %>% html_nodes("head") %>% html_nodes("title") %>% html_text()

    # Try different CSS selectors
    html %>% html_nodes(".institute")
    html %>% html_nodes(".institute > img")
    html %>% html_nodes(".institute > img") %>% html_text()  # empty string
    html %>% html_nodes(".institute > img") %>% html_attr("src")
    html %>% html_nodes(".institute > img") %>% html_attr("alt")

    html %>% html_nodes("ul.member > li > ol > li > a")
    html %>% html_nodes("ul.member > li > ol > li > a") %>% html_text()
    html %>% html_nodes("ul.member > li > ol > li > a") %>% html_attr("href")
    ```
</div>


## Your Turn (3 min)

從你上次的作業抓出「姓名」、「系級」、「學號」 --> 在 R 中變成 3 個字串 (3 chr vectors)

- Demo: IVO

    ```r
    req <- GET("https://ivotung1129.github.io/my_webpage/index.html")
    req[["status_code"]]
    html <- content(req)

    id <- html %>% html_nodes("#identity") %>% html_text() %>% strsplit(" ") %>% .[[1]]
    dept <- id[1]
    id_num <- id[2]
    student <- id[3]
    ```

## Web devtools

<div class="hide" data-tag="devtools">

**slide**

- 實際的網頁很複雜，要如何**快速**找到自己想要的資料的 CSS selector

**demo: chrome**

- chrome devtools
- target: footer rlads2019 link (under `p.copyright`)

**demo: r**

```r
req <- GET("https://rlads2019.github.io/lab/")
req[["status_code"]]
html <- content(req)

html %>% html_nodes("p.copyright > a")
html %>% html_nodes("p.copyright > a") %>% html_text()
html %>% html_nodes("p.copyright > a") %>% html_attr("href")
```
</div>

- **3 min**

## 不必凡事都親自動手 (用別人寫好的套件)

## 課程總結 (實習課的期待)

- R 程式基礎, 資料分析, 文本分析
    - base R, `tidyverse`, `quanteda`
- 使用 GitHub 管理程式碼
    - GitHub Desktop (作業繳交)
    - (上週) 請大家自行建立一個 GitHub Repo
- 將努力成果 (透過網頁) 保存與分享
    - R Markdown, GitHub, GitHub Pages


## Apologies

- 資質 
    1. 實習課很難，塞給大家很多東西
    2. 如果過程中很**挫折**，(我很抱歉)，最重要的是：不要覺得自己**笨**或**資質不足**
    3. 可以撐到現在，就代表資質是足夠的，甚至比足夠多上許多
- 樂趣
    1. 如果你覺得寫程式很**痛苦**，(一樣，再次跟同學抱歉，我是第一次教程式，許多地方拿捏的不是很好，帶給了一些同學很大的壓力)
    2. 但是如果寫程式的過程中有那麼 **一丁點**、**一瞬間** 的樂趣，希望同學可以努力記下這個感覺
    3. 剛學寫程式最痛苦的時候，但痛苦只會越來越少，樂趣卻會越來越多
    4. 一旦掌握寫程式的樂趣，你們就算是學會寫程式了
    5. 只要你們有樂趣，要掌握程式語言裡面比較技術性的細節，就只是時間的問題而已
- 期末專案 (掌握樂趣的方式)
    1. 這學期剩下的期末專案是個很好的機會。
    2. 因為，大家不是為了學程式而寫程式，而是為了**解決實際問題**而寫程式
    3. 這會比回答作業的問題有趣許多
    4. 這過程中，大家也有可能會遇到自己非常**陌生**的事物
        - Don't be afraid --> 經過一學期的實習課，能力足夠
        - 只是需要沉下氣來，花些時間了解這東西如何運作
        - 往往會發現這些東西比想像中的簡單
        - 看到新的風景 (其它領域的知識、其他人的想法)
    5. 這是我寫程式很大的動力來源